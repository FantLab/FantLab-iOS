require 'yaml'

ENV["COCOAPODS_DISABLE_STATS"] = "1"

platform :ios, '11.0'

workspace 'FantLab-iOS'

project 'FantLab-iOS.xcodeproj'
project 'Modules.xcodeproj'

use_modular_headers!
inhibit_all_warnings!

def release_pods
    pod 'Firebase/Core', :configurations => ['Adhoc', 'Release']
    pod 'Fabric', :configurations => ['Adhoc', 'Release']
    pod 'Crashlytics', :configurations => ['Adhoc', 'Release']
end

def all_pods
    release_pods

    pod 'RxSwift', '4.4.2'
    pod 'GRDB', :podspec => 'podspecs/GRDB.podspec'
    pod 'RxGRDB', :podspec => 'podspecs/RxGRDB.podspec'
    pod 'YYWebImage', '1.0.5'
    pod 'ALLKit', :git => 'https://github.com/geor-kasapidi/ALLKit', :commit => '17a07be76d90bd638742194f742b5c8aaab29164'
end

target 'FantLab-iOS' do
    project 'FantLab-iOS.xcodeproj'

    all_pods

    target 'FantLab-iOSTests' do
        inherit! :search_paths
    end
end

modules = YAML.load_file('Modules.yaml')

modules.keys.sort.each do |target_name|
    target target_name do
        project 'Modules.xcodeproj'

        all_pods
    end
end
